# Enumeration with WMIC
#enumeration #wmic #windows 

### List antivirus software

```
wmic /namespace:\\\\root\\securitycenter2 path antivirusproduct GET displayName,productState,pat  
hToSignedProductExe
```

### Information about the OS 

```
wmic computersystem list full
```

### Availible volumes 

```
wmic volume list brief
```

### List Updates

```
wmic qfe list brief
```

### Search files containing 'password' in the name

```
wmic DATAFILE where "drive='C:' AND Name like '%password%'" GET Name,readable,size /VALUE
```

### Get local user accounts

```
wmic useraccount list
```

### Domain DC and Information

```
wmic NTDOMAIN GET DomainControllerAddress,DomainName,Roles
```

### List all users 

```
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samacountname
```

### Get all groups 

```
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samacountname
```

### Members of domain admins group 

```
wmic path win32_groupuser where (groupcomponent="win32_group.name='domain admins', domain='YOURDOMAINHERE'")
```

### List all computers

```
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname 
```

### Logged on user 

```
Get-WmiObject -Query "select * from Win32_LoggedOnUser" | ?{$_.LogonType -notmatch '(Service|Network|System)'}
```